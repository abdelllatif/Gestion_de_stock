<style>
.submenu-link {
    font-size: 0.88em;
    margin-left: 0.5rem;
    padding-left: 2.2rem;
    color: #b9c6e0;
    background: none;
    border-radius: 6px;
    transition: background 0.2s, color 0.2s;
}
.submenu-link:hover, .submenu-link.active {
    background: linear-gradient(90deg, #1e3a8a, #3b82f6);
    color: #fff !important;
}
.stock-movement-btn {
    color: #b9c6e0;
    background: none;
    border-radius: 8px;
    transition: background 0.2s, color 0.2s;
}
.stock-movement-btn.active {
    background: linear-gradient(90deg, #1e3a8a, #3b82f6);
    color: #fff !important;
}
</style>
<div class="d-flex flex-column h-100 justify-content-between " style="height: calc(100vh - 60px); padding-top: 60px; background-color: #232946;">
    <div style="overflow-y: auto; max-height: calc(100vh - 20px); scrollbar-width: thin;">
      <!--
      <h2 class="text-white text-center mb-4" style="font-family: 'Segoe UI', sans-serif; letter-spacing: 2px;">Dashboard</h2> -->
        <ul class="nav nav-pills flex-column mb-auto">
            <li class="nav-item mb-2">
                <a href="/" class="nav-link {% if activeLink == 'dashboard' %}text-white{% endif %}" style="{% if activeLink == 'dashboard' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-speedometer2 me-2"></i> Tableau de bord
                </a>
            </li>
            <li class="nav-item mb-2">
                <a href="/utilisateur" class="nav-link {% if activeLink == 'utilisateur' %}text-white{% endif %}" style="{% if activeLink == 'utilisateur' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-people me-2"></i> Utilisateurs
                </a>
            </li>
            <li class="nav-item mb-2">
                <button type="button" id="stockMovementToggle" class="nav-link w-100 text-start stock-movement-btn{% if activeLink == 'stock_movement' %} active{% endif %}" style="display: flex; align-items: center; justify-content: space-between;">
                    <span><i class="bi bi-box-seam me-2"></i> Mouvements de stock</span>
                    <span id="chevron" style="transition: transform 0.2s;">&#8250;</span>
                </button>
                <div id="stockMovementSubmenu" style="display: none;">
                    <a href="/stock/movement" class="nav-link submenu-link mb-1{% if app.request.getRequestUri() starts with '/stock/movement' %} active{% endif %}">Mouvement des articles</a>
                    <a href="/stock_movement/machine" class="nav-link submenu-link{% if app.request.getRequestUri() starts with '/stock_movement/machine' %} active{% endif %}">Mouvement des machines</a>
                </div>
            </li>
            <li class="nav-item mb-2">
                <a href="/machine" class="nav-link {% if activeLink == 'machine' %}text-white{% endif %}" style="{% if activeLink == 'machine' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-gear me-2"></i> Machines
                </a>
            </li>
            <li class="nav-item mb-2">
                <a href="/facture" class="nav-link {% if activeLink == 'facture' %}text-white{% endif %}" style="{% if activeLink == 'facture' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-receipt me-2"></i> Factures
                </a>
            </li>
            <li class="nav-item mb-2">
                <a href="/depot" class="nav-link {% if activeLink == 'depot' %}text-white{% endif %}" style="{% if activeLink == 'depot' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-house-door me-2"></i> Dépôts
                </a>
            </li>
            <li class="nav-item mb-2">
                <a href="/commande_client" class="nav-link {% if activeLink == 'commande_client' %}text-white{% endif %}" style="{% if activeLink == 'commande_client' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-cart me-2"></i> Commandes Clients
                </a>
            </li>
            <li class="nav-item mb-2">
                <a href="/client" class="nav-link {% if activeLink == 'client' %}text-white{% endif %}" style="{% if activeLink == 'client' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-person-badge me-2"></i> Clients
                </a>
            </li>
            <li class="nav-item mb-2">
                <a href="/chauffeur" class="nav-link {% if activeLink == 'chauffeur' %}text-white{% endif %}" style="{% if activeLink == 'chauffeur' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-truck me-2"></i> Chauffeurs
                </a>
            </li>
            <li class="nav-item mb-2">
                <a href="/chantier" class="nav-link {% if activeLink == 'chantier' %}text-white{% endif %}" style="{% if activeLink == 'chantier' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-building me-2"></i> Chantiers
                </a>
            </li>
            <li class="nav-item mb-2">
                <a href="/bon" class="nav-link {% if activeLink == 'bon' %}text-white{% endif %}" style="{% if activeLink == 'bon' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-file-earmark-text me-2"></i> Bons
                </a>
            </li>
            <li class="nav-item mb-2">
                <a href="/article" class="nav-link {% if activeLink == 'article' %}text-white{% endif %}" style="{% if activeLink == 'article' %}background: linear-gradient(90deg, #1e3a8a, #3b82f6); border-radius: 8px;{% else %}border-radius: 8px;{% endif %}">
                    <i class="bi bi-archive me-2"></i> Articles
                </a>
            </li>
        </ul>
    </div>

    <div class="mt-4" style="border-top: 1px solid #b9c6e0; margin-top: 2rem; padding-top: 1rem;">
    <ul class="nav flex-column">
        <li class="nav-item mb-2">
            <a href="/profile" class="nav-link d-block text-secondary" style="border-radius: 8px; padding: 8px 12px;">
                <i class="bi bi-person-circle me-2"></i> Profil
            </a>
        </li>
        <li class="nav-item mb-2">
            <a href="/logout" class="nav-link d-block text-danger" style="border-radius: 8px; padding: 8px 12px;">
                <i class="bi bi-box-arrow-right me-2"></i> Déconnexion
            </a>
        </li>
        <li class="nav-item">
            <span class="d-block" style="border-radius: 8px; padding: 8px 12px; color:rgb(37, 85, 181);">
                © {{ "now"|date("Y") }}  Enterprise
            </span>
        </li>
    </ul>
</div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var toggle = document.getElementById('stockMovementToggle');
    var submenu = document.getElementById('stockMovementSubmenu');
    var chevron = document.getElementById('chevron');
    if (toggle) {
        toggle.addEventListener('click', function() {
            if (submenu.style.display === 'none' || submenu.style.display === '') {
                submenu.style.display = 'block';
                chevron.style.transform = 'rotate(90deg)';
            } else {
                submenu.style.display = 'none';
                chevron.style.transform = 'rotate(0deg)';
            }
        });
    }
    // Optionally, open submenu if activeLink is stock_movement
    {% if activeLink == 'stock_movement' %}
    submenu.style.display = 'block';
    chevron.style.transform = 'rotate(90deg)';
    {% endif %}
});
</script>
